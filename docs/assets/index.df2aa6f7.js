var ee=Object.defineProperty,te=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var K=(e,n,a)=>n in e?ee(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,P=(e,n)=>{for(var a in n||(n={}))ae.call(n,a)&&K(e,a,n[a]);if(W)for(var a of W(n))se.call(n,a)&&K(e,a,n[a]);return e},I=(e,n)=>te(e,ne(n));import{P as R,r as d,j as t,M as j,a as z,b as m,c as re,T as le,d as ue,u as ce,e as H,f as oe,F as ie,g as de,h as pe,i as fe,k as he,l as me,m as ge,n as ye,t as Ce}from"./vendor.800f8aeb.js";const ke=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))u(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&u(f)}).observe(document,{childList:!0,subtree:!0});function a(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function u(s){if(s.ep)return;s.ep=!0;const r=a(s);fetch(s.href,r)}};ke();function v(e){switch(e){case 5:return"\u2605\u2605\u2605\u2605\u2605";case 4:return"\u2605\u2605\u2605\u2605";case 3:return"\u2605\u2605\u2605";case 2:return"\u2605\u2605";default:return"\u2605"}}const be=({position:e,item:n,isActive:a,map:u})=>{const{url:s,name:r,address:f,wifi:c,seat:i,quiet:o,tasty:k,cheap:p,music:y}=n,[b,N]=d.exports.useState(!1);let g=d.exports.useRef();return d.exports.useEffect(()=>{b&&a&&(g.openOn(u),u.panTo({lat:e[0],lng:e[1]}))},[a,b,u,e]),a?t(j,{position:{lat:e[0],lng:e[1]},children:t(z,{ref:C=>{g=C,N(!0)},children:m("div",{children:[t("span",{style:{fontWeight:800,fontSize:"16px"},children:r}),t("br",{}),m("span",{children:[f,t("br",{}),c>0?`WIFI\u7A69\u5B9A: ${v(c)} `:" ",c>0?t("br",{}):"",i>0?`\u901A\u5E38\u6709\u4F4D:  ${v(i)} `:" ",i>0?t("br",{}):"",o>0?`\u5B89\u975C\u7A0B\u5EA6:  ${v(o)} `:" ",o>0?t("br",{}):"",k>0?`\u5496\u5561\u597D\u559D:  ${v(k)} `:" ",k>0?t("br",{}):"",p>0?`\u50F9\u683C\u4FBF\u5B9C:  ${v(p)} `:" ",p>0?t("br",{}):"",y>0?`\u88DD\u6F62\u97F3\u6A02:  ${v(y)} `:" ",y>0?t("br",{}):""]}),s?t("a",{href:s,children:"\u7C89\u7D72\u5C08\u9801"}):""]})})}):null};function Ne({isMenuOpen:e,toggleMenu:n}){return ce("click",()=>{e&&n()}),null}function X({position:e,isMenuOpen:n,toggleMenu:a,item:u,items:s}){const[r,f]=d.exports.useState(),{latitude:c,longitude:i}=u,o=[parseFloat(c),parseFloat(i)],k=s.filter(p=>p.lat).map((p,y)=>t(j,{opacity:.6,position:[parseFloat(p.lat),parseFloat(p.lng)],children:t(z,{children:t("div",{dangerouslySetInnerHTML:{__html:p.popup}})})},`${p.lat}${p.lng}${y}`));return m(re,{center:e,zoom:12,maxZoom:18,zoomControl:!1,animate:!0,whenCreated:f,children:[t(Ne,{isMenuOpen:n,toggleMenu:a}),t(le,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t(be,{position:o,map:r,data:{position:[20.27,-156]},item:u,isActive:c&&u.name}),t(ue,{children:k})]})}X.propTypes={isMenuOpen:R.bool.isRequired,toggleMenu:R.func.isRequired};const U=({toggleMenu:e})=>t("button",{type:"button",id:"menu-button",onClick:n=>{const a=e;n.preventDefault(),a()},children:t("div",{className:"hamburger",children:t("div",{className:"inner"})})});U.propTypes={toggleMenu:R.func.isRequired};const Ee=()=>({type:"TOGGLE_MENU"}),Se=e=>({type:"TOGGLE_CHECK",payload:e}),V=e=>({type:"TOGGLE_CONDITION",payload:e}),G=[{name:"taipei",displayName:"\u53F0\u5317",lng:121.5598,lat:25.08,checked:!0},{name:"keelung",displayName:"\u57FA\u9686",lng:121.7081,lat:25.10898,checked:!1},{name:"taoyuan",displayName:"\u6843\u5712",lng:121.300974,lat:24.993312,checked:!1},{name:"hsinchu",displayName:"\u65B0\u7AF9",lng:120.9647,lat:24.80395,checked:!1},{name:"miaoli",displayName:"\u82D7\u6817",lng:120.820793,lat:24.565031,checked:!1},{name:"taichung",displayName:"\u53F0\u4E2D",lng:120.645756,lat:24.176912,checked:!1},{name:"changhua",displayName:"\u5F70\u5316",lng:120.4818,lat:23.99297,checked:!1},{name:"nantou",displayName:"\u5357\u6295",lng:120.9876,lat:23.83876,checked:!1},{name:"yunlin",displayName:"\u96F2\u6797",lng:120.3897,lat:23.75585,checked:!1},{name:"chiayi",displayName:"\u5609\u7FA9",lng:120.574,lat:23.45889,checked:!1},{name:"tainan",displayName:"\u53F0\u5357",lng:120.1851,lat:23.005181,checked:!1},{name:"kaohsiung",displayName:"\u9AD8\u96C4",lng:120.312019,lat:22.623045,checked:!1},{name:"pingtung",displayName:"\u5C4F\u6771",lng:120.62,lat:22.54951,checked:!1},{name:"yilan",displayName:"\u5B9C\u862D",lng:121.7195,lat:24.69295,checked:!1},{name:"hualien",displayName:"\u82B1\u84EE",lng:121.3542,lat:23.7569,checked:!1},{name:"taitung",displayName:"\u53F0\u6771",lng:120.9876,lat:22.98461,checked:!1},{name:"penghu",displayName:"\u6F8E\u6E56",lng:119.6151,lat:23.56548,checked:!1}],q=[{name:"socket",displayName:"\u63D2\u5EA7",checked:!1},{name:"quiet",displayName:"\u5B89\u975C",checked:!1},{name:"wifi",displayName:"\u7DB2\u8DEF",checked:!1}];function ve({setPosition:e,checkedCities:n,checkedConditions:a,dispatch:u,toggleMenu:s}){const r=G.map((c,i)=>m("li",{className:"nav__li",children:[t("input",{id:c.name,type:"checkbox",checked:n[i],onChange:()=>{const o=n.slice();o[i]=!n[i],n[i]||e([c.lat,c.lng]),u(Se(o)),s()}}),t("label",{htmlFor:c.name,className:"nav__label",children:c.displayName})]},c.name)),f=q.map((c,i)=>m("li",{className:"nav__li",children:[t("input",{id:c.name,type:"checkbox",checked:a[i],onChange:()=>{const o=a.slice();o[i]=!a[i],u(V(o)),s()}}),t("label",{htmlFor:c.name,className:"nav__label nav__label--condition",children:c.displayName})]},c.name));return t("nav",{children:m("ul",{children:[f,t("br",{}),r]})})}function _e(e){return{checkedCities:e.checkedCities,checkedConditions:e.checkedConditions}}var $e=H(_e)(ve);const{lunr:we}=window,Z=we(function(){this.field("name"),this.field("address"),this.field("strSocket"),this.field("quietAways"),this.field("wifiGood")}),_=G.map(e=>e.coffeeShops?e:I(P({},e),{coffeeShops:[]})),Fe=async e=>{const n=await oe.get(`/coffee-map//cafedata/${e.name}.json`);return n.data&&(n.data.forEach(a=>{Z.add(I(P({},a),{strSocket:a&&a.socket==="yes"?"\u63D2\u5EA7":"",quietAways:a&&a.quiet>3?"\u5B89\u975C":"",wifiGood:a&&a.wifi>3?"\u7DB2\u8DEF":""}))}),e.coffeeShops=n.data,e.checked=!0),e};async function De(e){const n=await Promise.all(e.map((u,s)=>u&&!_[s].coffeeShops.length?Fe(_[s]):(u||(_[s].checked=!1),u&&(_[s].checked=!0),_[s])));let a=[];return n.forEach(u=>{u.checked&&(a=a.concat(u.coffeeShops))}),a}async function Le(e){let n=[];if(e.toString().trim()!==""){const a=await Z.search(e);if(a&&a.length){const u=a.map(r=>r.ref);let s=[];_.filter(r=>r.checked).forEach(r=>{s=s.concat(r.coffeeShops)}),s=s.filter(r=>u.indexOf(r.id)!==-1),n=s}}return n}const J={getCoffee:De,searchWithKeyWord:Le};function Me({onHover:e,checkedConditions:n,nowItem:a,toggleCondition:u}){let s="";const r=d.exports.useRef(null),f=10,[c,i]=d.exports.useState(1),[o,k]=d.exports.useState([]),[p,y]=d.exports.useState([]),[b,N]=d.exports.useState("\u7DB2\u8DEF"),g=q.filter((l,w)=>n[w]).map(l=>l.displayName).join(" "),C=d.exports.useCallback(async l=>{l&&l.preventDefault();const w=await J.searchWithKeyWord(`${g} ${b}`);k(w)},[g,b]);function E(l){N(l.target.value)}function D(l){l.key==="Enter"&&r.current.blur()}function $(l){l&&a&&l.id!==a.id&&(e(l),r.current.blur())}function L(){u(),N(""),y([])}function h(l){l.target.scrollTop>l.target.clientHeight*c&&o.length>f*c&&i(c+1)}d.exports.useEffect(()=>{g!==""&&setTimeout(()=>{C()},50)},[g,C]),d.exports.useEffect(()=>{o.length&&y(o.slice(0,f*c))},[o,c]),p.length&&(s=p.map(l=>m("div",{role:"presentation",className:"card",onClick:()=>{$(l),r.current.blur()},onFocus:()=>{$(l)},onTouchMove:()=>{$(l)},children:[t("h4",{children:l.name}),m("ul",{children:[t("li",{children:m("ol",{children:[l.limited_time==="no"?t("li",{children:"\u7121\u9650\u6642"}):"",l.socket!==""||l.socket!=="no"?t("li",{children:"\u63D2\u5EA7"}):"",l.wifi>3?t("li",{children:"WIFI"}):"",l.quiet>3?t("li",{children:"\u8F03\u5B89\u975C"}):"",l.cheap>3?t("li",{children:"\u8F03\u4FBF\u5B9C"}):""]})}),t("li",{children:`\u5730\u5740:${l.address}`}),l.open_time?t("li",{children:`\u71DF\u696D\u6642\u9593: ${l.open_time}`}):"",t("li",{children:t("a",{href:l.url,children:"\u7C89\u7D72\u5C08\u9801"})})]})]},l.id)));let S="\u8F38\u5165\u5E97\u540D \u5730\u5740";g&&(S=`\u67E5\u8A62\u689D\u4EF6:${g}`);let F=t("button",{type:"submit",className:"btn search__button",onClick:C,children:m("svg",{viewBox:"0 0 100 100",children:[t("circle",{id:"circle",cx:"45",cy:"45",r:"30"}),t("path",{id:"line",d:"M45,45 L100,100"})]})});return(b!==""||g!=="")&&(F=t("button",{type:"button",className:"btn search__button",onClick:L,children:t("span",{children:"\u2715"})})),m(ie,{children:[t("div",{className:"search-container",children:m("form",{onSubmit:C,children:[t("input",{value:b,onChange:E,ref:r,onClick:()=>{C()},onKeyPress:D,placeholder:`${S}`}),F]})}),t("div",{className:"search__result row",onScroll:h,children:t("div",{children:s})})]})}function Q({isMenuOpen:e,checkedCities:n,checkedConditions:a,toggleMenu:u,toggleCondition:s}){const[r,f]=d.exports.useState({name:"\u641C\u5C0B\u60F3\u53BB\u7684\u5496\u5561\u5E97~",address:"\u986F\u793A\u5730\u5740\u53CA\u7C89\u5C08"}),[c,i]=d.exports.useState({lng:121.5598,lat:25.08}),[o,k]=d.exports.useState([]),[p,y]=d.exports.useState(!0),b=r;let N=o;const g=e?"menu-open":"";let C="";function E(h){switch(h){case 5:return"\u2605\u2605\u2605\u2605\u2605";case 4:return"\u2605\u2605\u2605\u2605";case 3:return"\u2605\u2605\u2605";case 2:return"\u2605\u2605";default:return"\u2605"}}function D(h){r&&h&&r.id!==h.id&&f(h)}function $(h){r&&h&&r.id!==h.id&&f(h),s()}async function L(h){y(!0);const S=await J.getCoffee(h);y(!1),k(S)}return d.exports.useEffect(()=>{L(n)},[n]),o.length===0?N=[{lat:24.8,lng:121.023,popup:"<div><span>\u76EE\u524D\u5C1A\u672A\u9078\u64C7\u4EFB\u4F55\u5730\u9EDE<br/>\u8ACB\u6309\u5DE6\u65B9\u529F\u80FD\u9375\u9032\u5165\u9078\u55AE\u9078\u64C7XD<br/></span></div>"}]:N=o.map(h=>{const{latitude:S,longitude:F,name:l,address:w,wifi:M,seat:O,quiet:A,tasty:x,cheap:T,music:B}=h;return{lat:parseFloat(S),lng:parseFloat(F),popup:`<div>
            <span style=${{fontWeight:800,fontSize:"16px"}}>${l}</span><br /> 
            <span>
            ${w}<br />
            ${M>0?`WIFI\u7A69\u5B9A: ${E(M)}`:""} ${M>0?"<br />":""}
            ${O>0?`\u901A\u5E38\u6709\u4F4D:  ${E(O)}`:""} ${O>0?"<br />":""}
            ${A>0?`\u5B89\u975C\u7A0B\u5EA6:  ${E(A)}`:""} ${A>0?"<br />":""}
            ${x>0?`\u5496\u5561\u597D\u559D:  ${E(x)}`:""} ${x>0?"<br />":""}
            ${T>0?`\u50F9\u683C\u4FBF\u5B9C:  ${E(T)}`:""} ${T>0?"<br />":""}
            ${B>0?`\u88DD\u6F62\u97F3\u6A02:  ${E(B)}`:""} ${B>0?"<br />":""}
            </span>
            ${r.url?`<a href=${r.url}>\u7C89\u7D72\u5C08\u9801</a>`:""}
          </div>`}}),p&&(C=t("div",{className:"loading__overlay",children:t("div",{className:"loading__content",children:t("div",{className:"loader",children:"Loading..."})})})),m("div",{className:"app",children:[C,m("div",{className:g,children:[t($e,{toggleMenu:u,setPosition:i}),t(U,{toggleMenu:u})]}),t("div",{className:"container-fluid pt-2 ",children:m("div",{className:"row",children:[t("div",{className:"col-md-5 col-sm-12 result__container",children:t(Me,{nowItem:r,toggleCondition:s,checkedConditions:a,onChange:$,onHover:D})}),t("div",{className:"pb-1 col-md-7 col-sm-12 map__container",children:t(X,{position:c,item:b,items:N,isMenuOpen:e,toggleMenu:u})})]})})]})}function Oe(e){return{isMenuOpen:e.isMenuOpen,checkedCities:e.checkedCities,checkedConditions:e.checkedConditions}}const Ae=e=>({toggleCondition:()=>e(V()),toggleMenu:()=>e(Ee())});Q.defaultProps={name:"Gary"};var xe=H(Oe,Ae)(Q);const Te=(e=!1,n)=>{switch(n.type){case"TOGGLE_MENU":return!e;default:return e}},Be=(e={name:"\u641C\u5C0B\u60F3\u53BB\u7684\u5496\u5561\u5E97~",address:"\u986F\u793A\u5730\u5740\u53CA\u7C89\u5C08"},n)=>{switch(n.type){case"SELECT_PLACE":return{name:"\u641C\u5C0B\u60F3\u53BB\u7684\u5496\u5561\u5E97~1",address:"\u986F\u793A\u5730\u5740\u53CA\u7C89\u5C08"};default:return e}},Pe=(e=[],n)=>{switch(n.type){case"ALL_PLACE":return[...e];default:return e}},Ie=G.map(e=>e.checked),Re=(e=Ie,n)=>{switch(n.type){case"TOGGLE_CHECK":return[...n.payload];default:return e}},Y=q.map(e=>e.checked),Ge=(e=Y,n)=>{switch(n.type){case"TOGGLE_CONDITION":return n.payload?[...n.payload]:Y;default:return e}},qe=de({checkedCities:Re,checkedConditions:Ge,isMenuOpen:Te,item:Be,items:Pe});window.process||(window.process={});pe.exports.createLogger();const We=[Ce],Ke=typeof window=="object"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):fe,je=Ke(he(...We)),ze=me(qe,je);ge.exports.render(t(ye,{store:ze,children:t(xe,{})}),document.getElementById("root"));
